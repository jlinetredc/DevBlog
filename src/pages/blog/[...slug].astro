---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// 1. Hàm này giúp Astro biết có bao nhiêu trang cần tạo ra dựa trên số lượng file Markdown
export async function getStaticPaths() {
    const blogEntries = await getCollection('blog');
    return blogEntries.map(entry => ({
        params: { slug: entry.slug }, 
        props: { entry },
    }));
}

// 2. Lấy dữ liệu bài viết từ props
const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={entry.data.title}>
    <article class="max-w-3xl mx-auto px-4 py-12">
        <a href="/" class="text-slate-400 hover:text-orange-600 text-sm mb-8 inline-block transition-colors">
            ← Quay lại danh sách
        </a>

        <header class="mb-12 border-b border-slate-100 pb-12">
            <div class="flex items-center flex-wrap gap-4 mb-8">
                <div class="flex items-center gap-3">
                    <span class="px-3 py-1 bg-orange-600 text-white text-[10px] font-black uppercase tracking-widest rounded shadow-sm shadow-orange-200">
                        {entry.data.category}
                    </span>
                    <time class="text-slate-400 text-sm font-medium">
                        {entry.data.pubDate.toLocaleDateString('vi-VN', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric'
                        })}
                    </time>
                </div>
            </div>
            
            <h1 class="text-4xl md:text-6xl font-black text-slate-900 leading-[1.1] mb-12 tracking-tight">
                {entry.data.title}
            </h1>
            
            <div class="relative">
                <div class="absolute left-0 top-0 bottom-0 w-1 bg-orange-500 rounded-full"></div>
                <p class="pl-6 text-xl md:text-2xl text-slate-500 leading-relaxed font-medium">
                    {entry.data.description}
                </p>
            </div>
        </header>

        <div class="prose prose-lg prose-slate prose-orange max-w-none">
            <Content />
        </div>

        <div class="mt-16 pt-8 border-t border-slate-100">
            <p class="text-slate-500 text-sm">
                Cảm ơn bạn đã đọc bài viết này. Nếu thấy hay, hãy chia sẻ nhé!
            </p>
        </div>
    </article>
</Layout>